<!-- /index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Dungeon — Sprites + Gender + Shop/Stairs</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<canvas id="gameCanvas"></canvas>
<canvas id="minimap" width="192" height="192"></canvas>

<div id="ui">
  <div class="topbar">
    <div class="hud-kv"><b>Floor:</b> <span id="hudFloor">1</span> <span style="opacity:.5">|</span> <b>Seed:</b> <span id="hudSeed">-</span></div>
    <div class="stat panel" style="width:260px">
      <div id="hpFill" class="fill hp" style="width:70%"></div>
      <div class="label" id="hpLbl">HP 70/100</div>
    </div>
    <div class="stat panel" style="width:220px">
      <div id="mpFill" class="fill mp" style="width:40%"></div>
      <div class="label" id="mpLbl">Mana 40/100</div>
    </div>
    <div class="stat panel" style="width:220px">
      <div id="xpFill" class="fill xp" style="width:0%"></div>
      <div class="label" id="xpLbl">XP 0/50</div>
    </div>
      <div class="hud-kv"><b>Gold:</b> <span id="hudGold">0</span></div>
      <div class="hud-kv"><b>Lvl:</b> <span id="hudLvl">1</span></div>
      <div class="hud-kv"><b>Score:</b> <span id="hudScore">0</span></div>
      <div class="hud-kv"><b>Kills:</b> <span id="hudKills">0</span></div>
      <div class="hud-kv"><b id="hudAbilityLabel">Spell:</b> <span id="hudSpell">None</span></div>
    <div class="hud-kv" id="hudDmg" style="opacity:.85">ATK 2-4 | CRIT 5% | ARM 0</div>
  </div>
  <div></div>
  <div class="footer">Sprites generated at runtime — multi-file</div>
</div>

<!-- Inventory -->
<div id="inventory" class="panel"></div>

<!-- Shop -->
<div id="shop" class="panel"></div>

<!-- Character Page -->
<div id="charPage" class="panel"></div>

<!-- Action Log -->
<div id="actionLog" class="panel"></div>

<div id="start" class="stone" style="position:fixed;inset:0;display:grid;place-items:center">
  <div class="panel" style="padding:18px 22px;max-width:780px">
    <h2 style="margin:6px 0 12px 0">Dungeon</h2>
    <div style="display:flex;gap:16px;align-items:flex-start">
      <p style="flex:1;opacity:.9">Procedurally generated dungeon with fog‑of‑war. Pick a character, find loot, trade at the merchant, and enter the portal.</p>
      <ul>
        <li>WASD / Arrow Keys — Move (8‑directional)</li>
        <li>I — Toggle Inventory</li>
        <li>E — Use Portal / Merchant</li>
        <li>Click monster — Attack</li>
      </ul>
    </div>

    <div class="section-title" style="margin-top:10px">Choose your class</div>
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:10px;pointer-events:auto">
      <label class="gender-card">
        <input type="radio" name="class" value="warrior" checked>
        <div class="gender-preview"><canvas id="prevWarrior"></canvas></div>
        <div>
          <div><b>Berserker</b></div>
          <div class="muted" style="font-size:12px">Massive HP and relentless damage</div>
        </div>
        </label>
        <label class="gender-card">
          <input type="radio" name="class" value="mage">
          <div class="gender-preview"><canvas id="prevMage"></canvas></div>
          <div>
            <div><b>Spellbinder</b></div>
            <div class="muted" style="font-size:12px">Extra mana, devastating spells</div>
          </div>
        </label>
        <label class="gender-card">
          <input type="radio" name="class" value="summoner">
          <div class="gender-preview"><canvas id="prevSummoner"></canvas></div>
          <div>
            <div><b>Soulcaller</b></div>
            <div class="muted" style="font-size:12px">Commands minions with arcane power</div>
          </div>
        </label>
        <label class="gender-card">
          <input type="radio" name="class" value="rogue">
          <div class="gender-preview"><canvas id="prevRogue"></canvas></div>
          <div>
            <div><b>Nightblade</b></div>
            <div class="muted" style="font-size:12px">Fast, lethal critical strikes</div>
          </div>
        </label>
      </div>

    <p class="hint" style="margin-top:10px">All sprites (player, monsters, portal, shop) are generated at runtime.</p>

    <label style="display:flex;align-items:center;gap:6px;margin-top:8px;pointer-events:auto">
      <input type="checkbox" id="mobileToggle"> Mobile Controls (iOS)
    </label>

      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="playBtn" class="btn">Play</button>
        <button class="btn" onclick="alert('Thanks for playing!')">Quit</button>
        <a href="controls.html" class="btn" style="text-decoration:none;display:inline-block">Controls</a>
      </div>
  </div>
</div>

<!-- Mobile Controls Overlay -->
<div id="mobileControls" style="display:none;position:fixed;inset:0;pointer-events:none">
  <div id="dpad">
    <button id="btnUp" class="mc-btn">▲</button>
    <button id="btnLeft" class="mc-btn">◀</button>
    <button id="btnDown" class="mc-btn">▼</button>
    <button id="btnRight" class="mc-btn">▶</button>
  </div>
  <button id="btnAction" class="mc-btn">E</button>
</div>

  <div id="respawn" class="stone" style="position:fixed;inset:0;display:none;place-items:center">
    <div class="panel" style="padding:18px 22px;text-align:center">
      <h2 style="margin:6px 0 12px 0">You suck, try again</h2>
      <p>Score: <span id="finalScore">0</span></p>
      <p>Floors Cleared: <span id="finalFloors">0</span></p>
      <p>Time Survived: <span id="finalTime">0</span>s</p>
      <p>Kills: <span id="finalKills">0</span></p>
      <div style="margin-top:8px;text-align:left">
        <div>Achievements:</div>
        <ul id="finalAchievements" style="margin:4px 0 0 16px;padding:0"></ul>
      </div>
      <button id="respawnBtn" class="btn">Respawn</button>
    </div>
  </div>

<div id="escMenu" class="stone" style="position:fixed;inset:0;display:none;place-items:center">
  <div class="panel" style="padding:18px 22px;text-align:center">
    <h2 style="margin:6px 0 12px 0">Paused</h2>
    <div style="display:flex;gap:8px;justify-content:center;margin-bottom:12px">
      <button id="escMainTab" class="btn">Main</button>
      <button id="escSettingsTab" class="btn">Settings</button>
    </div>
    <div id="escMainPanel" style="display:flex;gap:8px;flex-direction:column">
      <button id="resumeBtn" class="btn">Resume</button>
      <button id="saveBtn" class="btn">Save Game</button>
      <button id="loadBtn" class="btn">Load Game</button>
    </div>
    <div id="escSettingsPanel" style="display:none;flex-direction:column;gap:8px;align-items:center">
      <div class="hud-kv" style="pointer-events:auto">
        <label style="display:flex;align-items:center;gap:6px;cursor:pointer">
          <input type="checkbox" id="smoothToggle" checked> Smooth
        </label>
      </div>
      <div class="hud-kv" style="display:flex;align-items:center;gap:6px;pointer-events:auto">
        <label for="speedRange">Speed</label>
        <input type="range" id="speedRange" min="60" max="220" value="140" step="5" style="width:140px">
      </div>
      <div class="hud-kv" style="display:flex;align-items:center;gap:4px;pointer-events:auto">
        <label for="masterVol">Vol</label>
        <input type="range" id="masterVol" min="0" max="1" step="0.01" value="1" style="width:80px">
        <label for="musicVol">Mus</label>
        <input type="range" id="musicVol" min="0" max="1" step="0.01" value="1" style="width:80px">
        <label for="sfxVol">SFX</label>
        <input type="range" id="sfxVol" min="0" max="1" step="0.01" value="1" style="width:80px">
      </div>
      <div class="hud-kv" style="display:flex;align-items:center;gap:4px;pointer-events:auto">
        <label for="minimapOpacity">Map</label>
        <input type="range" id="minimapOpacity" min="0.2" max="1" step="0.05" value="0.8" style="width:80px">
      </div>
    </div>
  </div>
</div>

<script src="assets/sprites.js"></script>
<script type="module" src="game.js"></script>
</body>
</html>
