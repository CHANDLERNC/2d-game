html,body{margin:0;background:#0b0b0e;color:#ddd;font-family:system-ui,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;overflow:hidden}
  #ui{position:fixed;inset:0;display:grid;grid-template-rows:auto 1fr auto;pointer-events:none}
  .topbar{display:flex;gap:16px;align-items:center;padding:8px 14px;background:linear-gradient(#191a1f,#111219);border-bottom:1px solid #2a2d39;transform:scale(1.2);transform-origin:top left;width:calc(100%/1.2)}
  .panel{background:rgba(15,16,22,0.9);border:1px solid #2a2d39;border-radius:10px;box-shadow:0 0 0 1px rgba(255,255,255,0.03) inset}
  .stat{height:14px;width:220px; background:#222;border:1px solid #333;border-radius:6px;position:relative}
  .fill{position:absolute;left:0;top:0;height:100%;background:#3c7}
  .fill.hp{background:#d44}
  .fill.mp{background:#47c}
  .fill.xp{background:#7a4bd9}
  .label{position:absolute;left:0;right:0;top:-18px;font-size:12px;opacity:.85;text-align:center}
  .hud-kv{font-size:13px;opacity:.9}
  #gameCanvas{position:fixed;left:0;top:0}
  .btn{display:inline-block;padding:8px 14px;border:1px solid #3a3e4d;border-radius:8px;background:#141622;color:#e6e6f0;cursor:pointer}
  .btn:hover{background:#1a1d2a}
  .stone{background-image:linear-gradient(180deg,rgba(255,255,255,.03),rgba(0,0,0,.08));}
  .footer{padding:6px 12px;border-top:1px solid #2a2d39;background:linear-gradient(#0f1016,#0b0c11);opacity:.85}
  #bossAlert{position:fixed;top:20px;left:50%;transform:translateX(-50%);padding:8px 14px;background:#141622;border:1px solid #3a3e4d;border-radius:8px;pointer-events:none;opacity:.95;z-index:1000}
  #inventory{display:none;position:fixed;right:8px;top:64px;padding:12px;pointer-events:auto;font-size:13px;width:900px;max-width:95vw}
  #shop{display:none;position:fixed;left:8px;top:64px;min-width:320px;width:620px;max-width:90vw;max-height:70vh;overflow:auto;padding:10px 12px;pointer-events:auto;font-size:13px}
  #magic{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);padding:8px 12px;pointer-events:auto;font-size:13px;width:340px;max-width:90vw;max-height:70vh;overflow:auto}
  #skills{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);padding:8px 12px;pointer-events:auto;font-size:13px;width:340px;max-width:90vw;max-height:70vh;overflow:auto}
  #charPage{display:none;position:fixed;top:64px;left:50%;transform:translateX(-50%);padding:8px 12px;pointer-events:auto;font-size:13px;width:320px;max-width:90vw}
  #actionLog{display:none;position:fixed;bottom:64px;left:50%;transform:translateX(-50%);padding:8px 12px;pointer-events:auto;font-size:13px;width:360px;max-width:90vw;max-height:50vh;overflow:auto}
  .shop-items{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .shop-item{display:flex;flex-direction:column;gap:4px;padding:6px;border-radius:6px}
.shop-item:hover{background:#1a1d28}
.list-row{display:flex;justify-content:space-between;gap:8px;padding:6px 6px;border-radius:6px}
.inv-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:4px 8px}
.inv-grid .list-row{flex-direction:column;gap:2px}

/* New inventory layout */
#inventory .inventory-layout{display:flex;gap:16px}
#inventory .inv-left{width:180px;display:flex;flex-direction:column;align-items:center}
#inventory .char-portrait{width:96px;height:96px;border:1px solid #2a2d39;border-radius:6px;background:#0f1119;margin-bottom:8px;display:flex;align-items:center;justify-content:center}
#inventory .equip-grid{display:grid;grid-template-columns:repeat(2,48px);gap:6px}
#inventory .inv-right{flex:1;display:flex;flex-direction:column}
#inventory .inv-slot{width:48px;height:48px;border:1px solid #2a2d39;border-radius:6px;background:#10131c;display:flex;align-items:center;justify-content:center;cursor:pointer}
#inventory .inv-slot.empty{opacity:.4}
#inventory .item-name{font-size:10px;text-align:center;display:block;padding:2px}
#inventory .potion-grid{display:grid;grid-template-columns:repeat(3,48px);gap:6px;margin-bottom:8px}
#inventory .bag-grid{display:grid;grid-template-columns:repeat(8,48px);gap:6px}
#inventory #invDetails{margin-top:8px;min-height:40px}
#inventory .inventory-footer{display:flex;gap:12px;margin-top:8px;font-size:12px}
#inventory .inventory-footer .footer-item{display:flex;align-items:center;gap:4px}
#inventory .list-row:hover{background:#1a1d28}
.skill-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:8px}
.skill-card{display:flex;flex-direction:column;gap:4px;padding:6px;border-radius:6px}
.skill-card:hover{background:#1a1d28}
.skill-tree{list-style:none;padding-left:16px}
.skill-tree ul{list-style:none;padding-left:16px;margin-top:4px}
.skill-tree li{margin:4px 0}
.muted{opacity:.75}
.kv{display:flex;gap:6px;align-items:center}
  .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  .pill{display:inline-block;padding:1px 6px;border:1px solid #2d3140;border-radius:999px;background:#10131c}
  .hr{height:1px;background:#2a2d39;margin:8px -8px}
  .hint{opacity:.8}
.actions{display:flex;gap:8px;flex-wrap:wrap}
  .sml{padding:6px 8px;font-size:12px;border-radius:6px}
  .section-title{font-weight:bold;margin:6px 0 4px}
  .item-title{font-weight:600}
  .green{color:#76d38b}
  .red{color:#ff6b6b}
  .gender-card{display:flex;align-items:center;gap:10px;padding:8px;border:1px solid #2a2d39;border-radius:10px;cursor:pointer}
  .gender-card:hover{background:#12141f}
  .gender-card input{accent-color:#7a4bd9}
  .gender-preview{width:32px;height:32px;border-radius:6px;background:#0f1119;display:grid;place-items:center}

/* Mobile controls */
#mobileControls{position:fixed;inset:0;pointer-events:none}
#dpad{position:absolute;bottom:80px;left:30px;width:120px;height:120px}
#dpad .mc-btn{position:absolute;width:40px;height:40px;border-radius:8px;background:#141622;border:1px solid #3a3e4d;color:#e6e6f0;opacity:.6;pointer-events:auto}
#dpad .mc-btn:active{opacity:.9}
#btnUp{left:40px;top:0}
#btnDown{left:40px;top:80px}
#btnLeft{left:0;top:40px}
#btnRight{left:80px;top:40px}
#btnAction{position:absolute;bottom:80px;right:30px;width:60px;height:60px;border-radius:30px;background:#141622;border:1px solid #3a3e4d;color:#e6e6f0;opacity:.6;pointer-events:auto}
#btnAction:active{opacity:.9}